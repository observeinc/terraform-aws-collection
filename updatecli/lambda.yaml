# updatecli.yaml
sources:
  AppsRelease:
    kind: "githubrelease"
    spec:
      owner: "observeinc"
      repository: "aws-sam-apps"
      token: '{{ requiredEnv "UPDATECLI_GITHUB_TOKEN" }}'
      versionFilter:
        kind: "semver"
        allowPrerelease: false
    transformers:
      - trimprefix: "v"

targets:
  updateLambdaBinaries:
    name: "Update binary release version"
    kind: file
    spec:
      file: "modules/samversion/main.tf"
      matchpattern: 'latest_release = "\S*"'
      replacepattern: 'latest_release = "{{ source `AppsRelease`}}"'
